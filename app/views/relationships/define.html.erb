<h1>Create Relationships</h1>

<h4>People in this document</h4>

<%= form_tag("/add_to_relationship", method: "get") do %>
<h5> choose left side of relationship </h5>
    <% @entities.each do |entity| %>
    <%= check_box_tag(:left_entity, entity.id) %>
    <%= label_tag(:left_entity, entity.name) %>
    <% end %>
<h5> choose right side of relationship</h5>
    <% @entities.each do |entity| %>
    <%= check_box_tag(:right_entity, entity.id) %>
    <%= label_tag(:right_entity, entity.name) %>
    <% end %>

<h5>Type of relationship</h5>
  <div class="field">
    <%= select_tag(:relationship_type, options_for_select(Relationship::Type::ALL_TYPES)) %>
  </div>

 <h5>Citation</h5>
  <div class="field">
    <%= text_field_tag :citation %>
  </div> 

<%= hidden_field_tag(:cwgk_id, @cwgk_id) %>
<%= submit_tag 'create relationships' %>
<% end %>

<h4>Existing relationships for these entities</h4>
<table class="table">
  <thead>
    <tr>
      <th>Entity 1</th>
      <th>Entity 2</th>
      <th>Relationship type</th>
      <th>User</th>
      <th>Citation</th>
      <th colspan="3"></th>
    </tr>
  </thead>
  <tbody>
    <% @relationships.each do |relationship| %>
      <tr>
        <td><%= link_to relationship.entity_1.name, edit_entity_path(relationship.entity_1.id) %></td>
        <td><%= link_to relationship.entity_2.name, edit_entity_path(relationship.entity_2.id) %></td>
        <td><%= relationship.relationship_type %></td>
        <td><%= relationship.user.email %></td>
        <td><%= relationship.citation %></td>
        <td><%= link_to 'Edit', edit_relationship_path(relationship) %></td>
        <td><%= link_to 'Destroy', relationship, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>